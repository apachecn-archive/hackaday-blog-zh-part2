# 良好的振动:给 HC-SR04 做一次大脑移植

> 原文：<https://hackaday.com/2014/03/17/good-vibrations-giving-the-hc-sr04-a-brain-transplant/>

[Emil]拿到了一打 HC-SR04 超声波传感器，但对它们的性能不太满意。他没有放弃，而是对传感器进行了逆向工程，制造了一个改进版本。自 20 世纪 80 年代初，宝丽来开始销售他们的 6500 声纳模块以来，黑客、制造商和机器人爱好者已经很容易获得标准的声纳平台。自那以后，许多公司都发布了声纳板，特别是[(Parallax Ping))模块](http://www.parallax.com/product/28015)。几年前，HC-SR04 作为 Ping 的低成本替代品出现在市场上。

[Emil]发现 HC-SR04 可以在距离传感器 4 米远的坚硬表面上可靠工作。然而，当使用软边目标或者根本没有目标时，他得到了许多坏数据。[Emil]逆向设计了 HC-SR04 的原理图，发现了一些有趣的设计决策。Max232 RS-232 转换器芯片用于其 ~~+-12V~~ +-10V 电荷泵。连接电荷泵以在超声波发射器处产生 ~~24V~~ 20V。掩模编程的微控制器管理整个单元，命令超声波发射器发送 40Khz 脉冲，并在系统的接收侧监听回波。[Emil]认为微处理器正在轮询模式下运行，因为它有时会丢失脉冲。更糟糕的是，微处理器运行在一个没有标记的 27MHz 晶体上，这个晶体有相当大的漂移。

[Emil]通过用 ATtiny24 和 12MHz 晶体创建自己的 PCB 解决了这些问题。他将引脚数从 4 个增加到 6 个，允许在电路中编程，并为 I2C 和 SPI 操作打开了大门。为了搭建电路板，[埃米尔]首先焊接他的微型和水晶。然后，他使用热风枪将所有元件从 HC-SR04 板上移到自己的板上。新电路板仍在测试中，但[Emil]已经公布了他的 PCB 和 BOM 数据。他还承诺在 AVR 代码可用时会公布出来。