# 逻辑噪声:更多 CMOS 牛铃！

> 原文:[https://hack aday . com/2015/04/10/logic-noise-more-CMOS-cow bell/](https://hackaday.com/2015/04/10/logic-noise-more-cmos-cowbell/)

[逻辑噪声](http://hackaday.com/tag/logic-noise/)是用 CMOS 逻辑芯片构建原始合成器的探索。这节课，我们将讨论钟，锣，钹，是的，还有牛铃，它们都有高度不和谐的内容。

## 金属的声音:异或

我使用“非谐波”这个术语是因为组成声音的频率甚至不是某个基本音高的整数倍，就像吉他弦或我们的方波一样。要发出这些金属声，我们需要把事情弄乱一点，我们今天介绍的逻辑函数就是异或(XOR)。

[https://www.youtube.com/embed/K4a7q5mosFI?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent](https://www.youtube.com/embed/K4a7q5mosFI?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent)T2】

XOR 逻辑门有两个输入，当其中一个且只有一个输入处于高电压电平时，它输出高电压。当两个输入都为低电平或高电平时，XOR 的输出为低电平。这对我们寻找非谐波内容有什么帮助？原来 XOR 逻辑函数是一个[混频器](https://en.wikipedia.org/wiki/Frequency_mixer)的数字版。(无线电发烧友们，注意了！)

理想的混频器接受两个输入频率，并输出两个输入频率的和与差。例如，如果输入 155 Hz 和 200 Hz，就会得到 45 Hz 时的差值和 355 Hz 时的总和。

因为我们使用方波和 XOR 而不是理想混频器，我们还会得到其他奇怪的值，如 2 * 155–200 = 110Hz 和 2 * 200–155 = 245Hz 等。总而言之，关键是我们得到了一堆不能被彼此整除的频率，这可以产生很好的金属声。(Dalek 为 T1 配音，不管怎样。)

## 4070:四路 XOR

![4070_pinout](../Images/052e5ae2806bd92dd22c518e17aa5468.png)

这让我们想到了今天的逻辑芯片。4070 是另一个 14 引脚的奇迹，就像 [40106](http://hackaday.com/2015/02/04/logic-noise-sweet-sweet-oscillator-sounds/) 和 [4069UB](http://hackaday.com/2015/03/09/logic-noise-sawing-away-with-analog-waveforms/) 一样，电源和接地引脚都在相同的位置。由于 XOR 门是一个三引脚的交易，有两个输入和一个输出，只有四个 XOR 适合在 14 引脚芯片上，而不是六个反相器。

到目前为止，您已经完全习惯了 4000 系列逻辑芯片，所以没有什么好说的了。这是一个很好的芯片，可以很容易地给你的项目添加声波伤害。

## 用 XOR 进行频率调制:更多牛铃！

让我们制造一些金属的声音。第一步是将两个振荡器混合在一起。像我们每次做的那样，在 40106 上搅拌两个可变频率振荡器，并分别听一听。现在将每个输出连接到 4070 中一个 XOR 门的输入。正如承诺的那样，产生的波形比两个输入中的任何一个都要复杂得多。

现在将它们相互调准，听所有奇怪的频率成分随着和与差的进出而产生。很酷，不是吗？[这里有一个额外的视频](http://youtu.be/lOxvuk7MrfM)，你可以跳过，但它演示了混频是怎么回事。

[https://www.youtube.com/embed/gBGyNFwXWn4?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent](https://www.youtube.com/embed/gBGyNFwXWn4?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent)T2】

## 双二极管 VCA

玩了几分钟后，你会开始意识到这听起来一点也不像牛铃。我们需要及时调整声音的音量，这意味着向“传统”合成器的方向又迈进了一步。我们将建立一个贫民区压控放大器(VCA)，并用世界上最简单的包络发生器驱动它。
[https://www.youtube.com/embed/ASMAVMIZmIo?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent](https://www.youtube.com/embed/ASMAVMIZmIo?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent)
有源 VCA 接收其输入信号，并根据施加在另一输入端的控制电压(CV)放大或衰减该信号。当控制电压较高时，更多的声音通过，当 CV 为零时，输出理想情况下是无声的。构建一个通用的 VCA 有点超出了我们的需求范围，所以让我们用几个二极管拼凑一些东西。

![](../Images/44d96c1a0906fbab6025c713d3528db6.png)

这种电路通过欺骗来工作，最适合我们所得到的数字逻辑信号。当 XOR 的输入为低电平时，二极管 D1 正向导通，所有控制电压信号被“吃掉”,进入 XOR 芯片的输出。

相反，当 XOR 为高电平时，二极管 D1 反向偏置，阻塞 CV，使其无处可去，只能通过二极管 D2 到达放大器。电阻需要足够大，以便 XOR 可以吸收其所有电流，否则大小并不重要。

注意这里发生了什么。输出电压不再是逻辑电路的 GND 到 VCC，而是仅从 GND 到控制电压(减去二极管压降)。因此，如果我们想制造更安静的 XOR 输入，我们只需降低控制电压。这是一个简单的电压控制衰减器。现在，我们只需创建一个电压信号，其幅度轮廓类似牛铃。

还记得我们如何通过增加一个串联电容将方波转换成触发脉冲吗？产生的电压急剧上升并呈指数下降。

如果我们加上另一个电容器，就可以延长衰变时间。当我们这样做的时候，我们可以加入一个电位计来控制衰减的速度。

![diode_vca_with_envelope_no_diodes](../Images/99784af4edb471e23dd9b23825b2d2c8.png)

电容器 C1 将方波转换成脉冲，并快速给 C2 充电，将正电压施加到 VCA 的输入端。C2 上的电荷通过可变衰减电位计排出。

这个简单的电路实际上工作良好，但有一个缺点。如上所述，对于较长的衰减时间，当控制方波变低时，衰减被切断。如果你只想要短打击乐，简单的电路就足够了。如果你也喜欢更长的衰减，你需要增加一对二极管来切断控制电压尖峰的负部分。

![diode_vca_with_envelope_sustain_no_diodes](../Images/fda8f01d1403dfef8888a74dd8e1944f.png)

现在，只有周期性正尖峰到达衰减电容，我们有了一个很好的可变速率指数衰减电压包络。这是它在示波器上的样子(有一些额外的电容减缓攻击— ![envelope_with_xor_drum](../Images/f432955619c9dfca436af28ae820d479.png)它可能已经连接到笔记本电脑声卡)。您可以清楚地看到，控制电压包络被二极管动作和 XOR 输出斩波。

将 XOR 频率调制的声音通过由我们快速而肮脏的包络发生器驱动的双二极管 VCA，可以获得一种敲击金属的声音。但它是牛铃吗？我们还得调整振荡器。

20 世纪 80 年代的经典、爱恨交织的牛铃声一定是[罗兰 TR-808](https://en.wikipedia.org/wiki/Roland_TR-808) 。如果你浏览一下 [808 维修手册](http://www.ericarcher.net/wp-content/uploads/2014/07/808-svc-man.pdf) (PDF 下载)你会发现它使用的是来自 40106 芯片的两个方波，只是简单地混合在一起。我们正在通过异或来改进这一点，但我们仍然可以从罗兰那里学到一些东西。特别是，他们把振荡器调到 540 赫兹和 800 赫兹。

因为我们将两个振荡器进行 xor 运算，所以峰值出现在和频和差频处。这意味着我们必须求解 X + Y = 800 和 X–Y = 540。拿起铅笔和纸，或者相信我，你会想把单个方波振荡器分别调到 130 和 670 赫兹。至少，得到一些像经典的干酪牛铃一样的声音。

## 撇开放大不谈

我们一直试图坚持使用纯粹的 CMOS 逻辑芯片，但这次会议我们打破了使用晶体管。原因是我们笔记本电脑上的音频输入坚持双极性、居中的音频信号。相比之下，我们的“VCA”的输出主要位于零伏，只有大约一伏的非常短的峰值。笔记本电脑中的输入电容正在充电，阻塞了 VCA 的二极管输出。嘘！

事实上，我们也不能使用 4069UB 作为放大器的老把戏。4069UB 非常适合以中轨电压为中心的信号，但在 GND 或 VCC 附近会失真。不幸的是，我们希望我们安静的鼓声逐渐减弱到零伏，而不是中轨，所以我们必须使用其他东西来缓冲我们的音频。

![quick_and_dirty_transistor_amp.sch](../Images/120023d12b9e1a32df19ec4967ee9320.png)

解决方案是用适合这种单极信号的东西来缓冲输出，最简单的解决方案是一个普通的 NPN 晶体管，连接成一个 ~~[共发射极放大器](https://en.wikipedia.org/wiki/Common_emitter)~~ [共集电极放大器](https://en.wikipedia.org/wiki/Common_collector)。这种配置是非常有用的模拟缓冲电路；它输出几乎相同的电压作为输入，但直接从 VCC 轨道，并肯定会处理任何声卡的输入电容。我们用的是 2N3904，但 2N2222 或 BC548 或其他什么都可以。

## 圆盘式张力装置

在早期的鼓机中，钹和类似的金属打击乐器的合成是相当复杂的。在 LinnDrum 推出样品钹之前，大多数只是使用一种成形的突发白噪声。前面提到的 TR-808 使用六个线性混合在一起的 40106 振荡器来近似白噪声。同样，我们将通过 xor 进行改进，结果介于许多振荡器和纯噪声之间，具体取决于如何设置振荡器。

[https://www.youtube.com/embed/XkRI6-WI_R0?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent](https://www.youtube.com/embed/XkRI6-WI_R0?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent)T2】

这个电路的灵感来自 1983 年《电子产品&音乐制作人》杂志上的奇妙的 Synbal 项目(PDF 格式的原理图)。这比我们在这里做的要复杂得多，但是如果你看示意图的左边，那就是核心。(如果您复制 Synbal 的振荡器固定频率，请注意，他使用 0.01 uF 电容，我们使用 0.1 uF 电容。相应地将反馈电阻除以 10。)

钹电路的诀窍是制造许多振荡器。我们将连接其中的六个，最终完全填满我们的 40106 芯片。然后在 XOR 中组合任意一对，取该 XOR 的输出，并将其与另一个振荡器组合。你现在有一个复杂的振荡器，用掉了三个 40106 振荡器和两个异或门。对剩下的振荡器和异或门重复这个步骤，你就差不多完成了。通过电阻将最后两个 XOR outs 连接到输出端。

与牛铃电路一样，通过选择不同的成分频率并调整衰减，可以使该电路听起来“真实”。我们认为，用几个音调很高(1 kHz 及以上)的振荡器可以发出相当不错的踩镲音。另一方面，如果你喜欢噪音音乐，你可以完全跳过 VCA，把振荡器调到相似的低频。你会听到一种模糊的金属声，几乎是有节奏的机器嗡嗡声。不容错过。

## 扩展ˌ扩张

我们在制造牛铃声音的伪装下偷偷加入了它，但是这里快速而肮脏的 VCA 对于调制我们在[前几节](http://hackaday.com/tag/logic-noise/)中制造的大多数合成器声音也是有用的。我们使用一个电容将驱动方波耦合到 VCA，进行敲击攻击，但没有理由不使用一个可变电阻来更慢地给电容充电。如果你这样做，请注意，攻击和衰减电位计将相互作用，所以这有点古怪，但你想要两个二极管吗？还要注意的是，你能想到的向两个二极管的连接点提供感兴趣的电压的任何其他方法都是公平的。

XOR 作为混频器的技术非常好，但是你也可以通过使用 XOR 作为逻辑芯片来获得很多好处。例如，将不同的分频时钟输出(比如来自 a 4040)与 xor 相结合，可以产生有趣的子模式。当 xor 与移位寄存器结合使用时，我们将在两个会话中得到更多的使用。

## 下一次会议

我们现在有很多可能性。我们有一些好的，和一些奇怪的，打击乐的声音。我们有一系列合成器声音，如果你还记得 4051，我们有一个很好的方法通过切换不同的电阻来调制它们。是时候开始整合这些东西了。

如果你跟着做，你的家庭作业是建立一对这样的电路的永久(或至少是准永久)版本，并得到至少两个 4017 十进制计数器芯片。因为下周我们将制作鼓的图案，并介绍另一种制作音乐的方法。