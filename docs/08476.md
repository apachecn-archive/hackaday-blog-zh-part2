# 解码伪装成. DOC 的宙斯恶意软件

> 原文：<https://hackaday.com/2015/03/06/decoding-zeus-malware-disguised-as-a-doc/>

[Ronnie]最近发布了他在解码恶意软件中的[冒险经历。他的一个用户报告了一封网络钓鱼邮件，结果确实包含了一个令人讨厌的附件。[Ronnie]为了弄清楚这个恶意软件试图做什么而遵循的过程非常有趣，值得一读。](http://phishme.com/decoding-zeus-disguised-as-an-rtf-file/ "Decoding obfuscated malware")

[Ronnie]从下载开始。虚拟机中的文档附件。这将隔离垃圾系统的任何潜在损害，使其易于恢复。当他试图打开。doc 文件时，他看到一个错误，指出他没有足够的内存或磁盘空间来继续。由于有 45GB 的可用空间和 2GB 的 RAM，这应该不成问题。肯定出了什么问题。

下一步是打开。Notepad++中的 doc 文件进行分析。[Ronnie]很快注意到该文件实际上是一个伪装成. doc 的. rtf 文件。[Ronnie]扫描了大量数据，试图猜测恶意软件试图做什么。他注意到一个数据块以字节“FF”和 D9”结尾，这两个字节也是。gif 文件。

[Ronnie]将这些数据复制到一个新文档中，并删除了所有新行和回车字符。然后，他将十六进制转换成 ASCII，揭示了更多的迹象，表明这实际上是图像数据。他将这个文件保存为. gif 格式，然后打开查看。这是一个 79KB 的三维渲染房子的图像。他还发现了另一大块数据，也是同样的图片，但大小是 3MB。至少可以说很奇怪。

在找到其他一些奇怪的数据后，[Ronnie]终于开始看到更多有趣的部分。首先，他注意到一些字符串混合了大写和小写字母，这是一种策略，有时用来避免反病毒签名。在稍低一点的地方，他发现了一段数据，其大小和典型的外壳代码差不多。他破译了这些数据，找到了他要找的东西。外壳代码包含一个可读的 URL。该 URL 指向一个恶意的。exe 文件碰巧还能在网上找到。

当然[罗尼]下载了。exe 并对其进行监控，以了解它的行为。他发现它在注册表中设置了一个 run 键，以确保它以后能够持久存在。该恶意软件将自己安装到用户的 appdata 文件夹中，并反复访问已知与 ZeuS 恶意软件相关的 IP 地址。这是一个很大的困惑，但它仍然不是一个有经验的恶意软件侦探的对手。