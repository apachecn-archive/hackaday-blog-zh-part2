# 从游戏内部重新编程超级马里奥世界

> 原文：<https://hackaday.com/2015/01/22/reprogramming-super-mario-world-from-inside-the-game/>

[SethBling]最近在最初的 SNES 硬件上创造了经典的超级任天堂游戏《超级马里奥世界》的世界纪录。他以 5 分 59.6 秒的成绩战胜了对手。这怎么可能呢？他实际上通过将特定的物体移动到非常特定的地方，然后执行一个小故障来重新编程游戏。这种击败游戏的方法最初是由 Twitch 用户[Jeffw356]发现的，但它是在模拟器上执行的[。[SethBling]能够证明这种“信用扭曲”故障在原始硬件上有效。](http://www.twitch.tv/jeffw356/c/4762957 "Emulator speed run")

如果你看下面的视频，你会看到[SethBling]访问游戏中第一个可用的级别之一。然后，他继续将游戏中的某些物体移动到非常具体的地方。他在这里做的是为精灵操纵游戏的 X 坐标表。通过移动物体到特定的地方，他操纵了游戏记忆的一部分来保存特定的值和特定的顺序。这是一个细致的过程，可能需要大量的练习才能做好。

一旦表设置正确，[SethBling]需要一种方法让 SNES 作为 CPU 指令执行 X 表。在《超级马里奥世界》中，马里奥可以获得一些特殊物品作为动力。例如，蘑菇会使他变大。游戏中的每个精灵都有一面旗帜来告诉 SNES 这个物品可以作为一种力量。马里奥既可以自己收集能量，也可以用他的友好恐龙耀西吃掉能量，这也会将该物品的效果应用到马里奥身上。

快速运行的下一部分涉及到一个叫做[物品交换故障](http://tasvideos.org/4315S.html "Item Swap Glitch")的东西。在游戏中，马里奥可以自己收集硬币，或者耀西也可以通过吃硬币来收集。有一个小故障，耀西可以开始吃硬币，但马里奥跳下耀西，同时自己收集硬币。结果是游戏知道耀西嘴里有*的东西*，但它不知道是什么。所以他最终拿着一个没有属性的空精灵。游戏只知道在雪碧槽 x 里的雪碧是什么。

现在是真正的物品交换。游戏里有一个敌人叫冲锋查克。这个精灵碰巧设置了一个标志，好像它是一个电源。通常这没关系，因为它也有一个设定的标志来告诉游戏它不能被耀西吃掉。此外，查克是一个敌人，所以它实际上伤害了马里奥，而不是作为一个动力。因此，在正常情况下，这个精灵实际上永远不会充当电源。开发人员从来没有对游戏进行编程来正确处理这种情况，因为这被认为是不可能的。

如果硬币故障发生在关卡中的特定位置，收集硬币后会产生一个充电吸盘。当吸盘产卵时，它会占据空的雪碧槽，突然游戏认为耀西把吸盘含在嘴里。这触发了开机条件，正如我们已经知道的，这是从来没有编入游戏。代码最终会跳转到不包含正常游戏指令的内存区域。

所有这些操作和故障的结果是 sprite X 坐标表中的所有值都作为 CPU 指令执行。[SethBling]设置此表以保存告诉游戏跳到结尾字幕的值。控制台执行它们并按照命令去做，游戏在开始几分钟后就结束了。下面的视频显示了速度跑，但没有深入到技术细节，但你可以在这里阅读更多信息。

这不是我们第一次看到这种类型的攻击。用非常相似的技术在口袋妖怪上进行了极速奔跑。另一名黑客设法在[口袋妖怪蓝](http://hackaday.com/2013/12/02/pokemon-blue-becomes-an-ide/ "Pokemon Blue hack")内部编写并执行了一个版本的单人游戏 pong。我们迫不及待地想看看这些游戏黑客下一步想出什么。

[https://www.youtube.com/embed/14wqBA5Q1yc?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent](https://www.youtube.com/embed/14wqBA5Q1yc?version=3&rel=1&showsearch=0&showinfo=1&iv_load_policy=1&fs=1&hl=en-US&autohide=2&wmode=transparent)