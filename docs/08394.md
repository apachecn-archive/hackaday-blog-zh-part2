# 黑掉俄克拉荷马州立大学的学生证

> 原文:[https://hack aday . com/2015/02/25/hacking-Oklahoma-state-universitys-student-id-cards/](https://hackaday.com/2015/02/25/hacking-oklahoma-state-universitys-student-id-cards/)

[Sam]2013 年在俄克拉荷马州立大学上了一堂信息安全课。对于他的最终项目，他和其他学生团队必须找到一个安全漏洞，然后设计一个理论计划来利用它。[山姆的]团队决定关注[学校的身份证](http://snelling.io/hacking-oklahoma-state-university-student-id "Hacking OSU ID cards")。OSU 的身份证与信用卡非常相似。它们有相同的大小和形状，它们有编码在磁条上的数据，它们有一个 16 位的识别号码。这些卡片有几种不同的用途。示例包括带照片的 ID、校园内某些区域的物理访问、在线帐户收费等等。

[Sam]和他的团队分析了 100 多种不同的卡片，以获得良好的样本。他们发现所有的卡片都以同样的八位数开头。这类似于信用卡号码的前六位数字中的发行人标识号。分析还显示，接下来的两位数字只有三种组合。那些要么是 05，06，要么是 11。考虑到这一点，通过数学计算，卡号的可能组合总数为 300 万。

OSU 还在每张卡的背面印了一个网址。这个网站有一个简单的表单，只有一个字段。用户可以输入一个 16 位的卡号，系统会告诉用户该卡是否有效。该页面还会告诉您持卡人是员工还是学生，或者卡上是否有任何其他特殊标志。我们不确定为什么每个学生都需要访问这个网站，但事实是 URL 就印在卡片的背面。该网站也没有限制查询次数。该大学意识到可能的安全隐患的唯一线索是网站上的免责声明。免责声明提到该工具的使用被“记录和跟踪”。

下一步是购买磁卡读写器。该小组解码了所有的卡片并分析了数据。他们发现每张卡都有有效期，但是每张卡的有效期都是一样的。该团队使用读写器从[Sam 的]卡上复制数据并修改名称。然后他们将数据写回到一张新的空白磁卡上。这张卡片上没有印刷或标记。[Sam]拿着这张卡，可以用它在校园里的一家商店购物。他注意到登记簿返回到某处的服务器以验证他的真实姓名。它没有对写在磁条上的名字做任何检查。尽管如此，收银员还是接受了一张没有官方标记的卡。

最后一步是写 node.js 脚本来刮号验证网站。只需 15 行代码，该脚本就能以随机顺序运行所有可能的数字组合，并记录结果。该网站每秒可以处理三到五个请求，这意味着可以在大约两天内完成所有可能的组合。这些收集到的数字可以被写在空白卡片上，并有可能被用来购买其他学生账户上的商品。

[Sam 的]团队提供了一些建议来提高该系统的安全性。一个想法是加入第二种形式的授权，比如 PIN。PIN 不会存储在卡上，因此不能以这种方式复制。主要建议是关闭验证网站。到目前为止，OSU 的回应是关闭网站，但没有其他变化。